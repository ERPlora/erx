<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>erx-gantt - ERX Components</title>
  <script type="module" src="https://unpkg.com/@erplora/erx/dist/erx/erx.esm.js"></script>
  <script nomodule src="https://unpkg.com/@erplora/erx/dist/erx/erx.js"></script>
  <link rel="stylesheet" href="../styles.css">
</head>
<body>
  <div class="component-page" style="padding: 2rem;">
    <a href="../index.html" class="back-link">&larr; Back to Components</a>
    <div class="component-header">
      <h1>erx-gantt</h1>
      <p>Gantt chart for project planning with multiple view modes (day/week/month/quarter), progress tracking, milestones, and hierarchical tasks.</p>
    </div>
    <div class="demo-section">
      <h2>Project Timeline (Week View)</h2>
      <div class="demo-box" style="overflow-x: auto;">
        <erx-gantt id="weekGantt"></erx-gantt>
      </div>
    </div>
    <div class="demo-section">
      <h2>Project Timeline (Month View)</h2>
      <div class="demo-box" style="overflow-x: auto;">
        <erx-gantt id="monthGantt"></erx-gantt>
      </div>
    </div>
    <div class="demo-section">
      <h2>Hierarchical Tasks with Progress</h2>
      <div class="demo-box" style="overflow-x: auto;">
        <erx-gantt id="hierarchicalGantt"></erx-gantt>
      </div>
    </div>
    <div class="demo-section">
      <h2>Event Output</h2>
      <div class="demo-box">
        <div id="eventOutput" style="padding: 1rem; background: var(--bg); border-radius: 8px; font-family: monospace; font-size: 0.875rem;">
          Click on a task to see the output...
        </div>
      </div>
    </div>
  </div>
  <script>
    const today = new Date();
    const daysFromNow = (days) => {
      const d = new Date(today);
      d.setDate(d.getDate() + days);
      return d.toISOString();
    };

    document.addEventListener('DOMContentLoaded', () => {
      const eventOutput = document.getElementById('eventOutput');

      // Week View Gantt
      document.getElementById('weekGantt').tasks = [
        {
          id: '1',
          name: 'Project Planning',
          start: daysFromNow(-7),
          end: daysFromNow(0),
          progress: 100,
          status: 'completed'
        },
        {
          id: '2',
          name: 'Design Phase',
          start: daysFromNow(-3),
          end: daysFromNow(7),
          progress: 60,
          status: 'in-progress',
          assignee: { name: 'Sarah Johnson' }
        },
        {
          id: '3',
          name: 'Development',
          start: daysFromNow(5),
          end: daysFromNow(21),
          progress: 0,
          status: 'pending',
          assignee: { name: 'John Smith' }
        },
        {
          id: '4',
          name: 'Testing',
          start: daysFromNow(18),
          end: daysFromNow(28),
          progress: 0,
          status: 'pending'
        },
        {
          id: '5',
          name: 'Launch',
          start: daysFromNow(30),
          end: daysFromNow(30),
          progress: 0,
          status: 'pending',
          milestone: true
        }
      ];
      document.getElementById('weekGantt').config = {
        viewMode: 'week',
        showProgress: true,
        showToday: true
      };

      // Month View Gantt
      document.getElementById('monthGantt').tasks = [
        {
          id: '1',
          name: 'Q1 Planning',
          start: daysFromNow(-30),
          end: daysFromNow(-15),
          progress: 100,
          status: 'completed'
        },
        {
          id: '2',
          name: 'Q1 Execution',
          start: daysFromNow(-15),
          end: daysFromNow(30),
          progress: 45,
          status: 'in-progress'
        },
        {
          id: '3',
          name: 'Q1 Review',
          start: daysFromNow(30),
          end: daysFromNow(30),
          progress: 0,
          status: 'pending',
          milestone: true
        },
        {
          id: '4',
          name: 'Q2 Planning',
          start: daysFromNow(30),
          end: daysFromNow(45),
          progress: 0,
          status: 'pending'
        },
        {
          id: '5',
          name: 'Q2 Execution',
          start: daysFromNow(45),
          end: daysFromNow(120),
          progress: 0,
          status: 'pending'
        }
      ];
      document.getElementById('monthGantt').config = {
        viewMode: 'month',
        showProgress: true,
        showToday: true
      };

      // Hierarchical Gantt
      document.getElementById('hierarchicalGantt').tasks = [
        {
          id: '1',
          name: 'Product Development',
          start: daysFromNow(-5),
          end: daysFromNow(35),
          progress: 40,
          status: 'in-progress',
          children: [
            {
              id: '1.1',
              name: 'Backend Development',
              start: daysFromNow(-5),
              end: daysFromNow(20),
              progress: 60,
              status: 'in-progress',
              assignee: { name: 'Mike Wilson' },
              children: [
                {
                  id: '1.1.1',
                  name: 'API Design',
                  start: daysFromNow(-5),
                  end: daysFromNow(0),
                  progress: 100,
                  status: 'completed'
                },
                {
                  id: '1.1.2',
                  name: 'Database Schema',
                  start: daysFromNow(-3),
                  end: daysFromNow(5),
                  progress: 80,
                  status: 'in-progress'
                },
                {
                  id: '1.1.3',
                  name: 'API Implementation',
                  start: daysFromNow(3),
                  end: daysFromNow(20),
                  progress: 20,
                  status: 'in-progress'
                }
              ]
            },
            {
              id: '1.2',
              name: 'Frontend Development',
              start: daysFromNow(5),
              end: daysFromNow(30),
              progress: 10,
              status: 'in-progress',
              assignee: { name: 'Emily Davis' }
            },
            {
              id: '1.3',
              name: 'Integration',
              start: daysFromNow(25),
              end: daysFromNow(35),
              progress: 0,
              status: 'pending'
            }
          ]
        },
        {
          id: '2',
          name: 'QA & Testing',
          start: daysFromNow(30),
          end: daysFromNow(45),
          progress: 0,
          status: 'pending'
        },
        {
          id: '3',
          name: 'Production Release',
          start: daysFromNow(50),
          end: daysFromNow(50),
          progress: 0,
          status: 'pending',
          milestone: true,
          color: '#10b981'
        }
      ];
      document.getElementById('hierarchicalGantt').config = {
        viewMode: 'week',
        showProgress: true,
        showToday: true
      };

      // Event listeners
      document.querySelectorAll('erx-gantt').forEach(gantt => {
        gantt.addEventListener('erxSelect', (e) => {
          const task = e.detail.task;
          eventOutput.innerHTML = `<strong>Task Selected:</strong> ${task.name}<br><strong>Progress:</strong> ${task.progress}%<br><strong>Status:</strong> ${task.status}`;
        });

        gantt.addEventListener('erxViewChange', (e) => {
          eventOutput.innerHTML = `<strong>View Changed:</strong> ${e.detail.viewMode}<br><strong>Start Date:</strong> ${e.detail.startDate.toDateString()}`;
        });
      });
    });
  </script>
</body>
</html>
