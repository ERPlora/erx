<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>erx-machine-status - ERX Components</title>
  <script type="module" src="https://unpkg.com/@erplora/erx/dist/erx/erx.esm.js"></script>
  <script nomodule src="https://unpkg.com/@erplora/erx/dist/erx/erx.js"></script>
  <link rel="stylesheet" href="../styles.css">
</head>
<body>
  <div class="component-page" style="padding: 2rem;">
    <a href="../index.html" class="back-link">&larr; Back to Components</a>
    <div class="component-header">
      <h1>erx-machine-status</h1>
      <p>Machine status display showing operational state, current job progress, real-time metrics, and alerts.</p>
    </div>

    <div class="demo-section">
      <h2>Running Machine</h2>
      <div class="demo-box">
        <erx-machine-status id="machine1"></erx-machine-status>
      </div>
    </div>

    <div class="demo-section">
      <h2>Machine with Alerts</h2>
      <div class="demo-box">
        <erx-machine-status id="machine2"></erx-machine-status>
      </div>
    </div>

    <div class="demo-section">
      <h2>Idle Machine</h2>
      <div class="demo-box">
        <erx-machine-status id="machine3"></erx-machine-status>
      </div>
    </div>

    <div class="demo-section">
      <h2>Multiple Machines (Compact)</h2>
      <div class="demo-box">
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
          <erx-machine-status id="machine4" compact></erx-machine-status>
          <erx-machine-status id="machine5" compact></erx-machine-status>
          <erx-machine-status id="machine6" compact></erx-machine-status>
          <erx-machine-status id="machine7" compact></erx-machine-status>
        </div>
      </div>
    </div>

    <div class="demo-section">
      <h2>Properties</h2>
      <div class="demo-box">
        <table style="width: 100%; border-collapse: collapse;">
          <thead>
            <tr style="border-bottom: 1px solid var(--border);">
              <th style="text-align: left; padding: 0.5rem;">Property</th>
              <th style="text-align: left; padding: 0.5rem;">Type</th>
              <th style="text-align: left; padding: 0.5rem;">Default</th>
              <th style="text-align: left; padding: 0.5rem;">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr style="border-bottom: 1px solid var(--border);">
              <td style="padding: 0.5rem;"><code>machine</code></td>
              <td style="padding: 0.5rem;">Machine</td>
              <td style="padding: 0.5rem;">-</td>
              <td style="padding: 0.5rem;">Machine data object (required)</td>
            </tr>
            <tr style="border-bottom: 1px solid var(--border);">
              <td style="padding: 0.5rem;"><code>show-metrics</code></td>
              <td style="padding: 0.5rem;">boolean</td>
              <td style="padding: 0.5rem;">true</td>
              <td style="padding: 0.5rem;">Show real-time metrics</td>
            </tr>
            <tr style="border-bottom: 1px solid var(--border);">
              <td style="padding: 0.5rem;"><code>show-alerts</code></td>
              <td style="padding: 0.5rem;">boolean</td>
              <td style="padding: 0.5rem;">true</td>
              <td style="padding: 0.5rem;">Show alert notifications</td>
            </tr>
            <tr style="border-bottom: 1px solid var(--border);">
              <td style="padding: 0.5rem;"><code>show-actions</code></td>
              <td style="padding: 0.5rem;">boolean</td>
              <td style="padding: 0.5rem;">true</td>
              <td style="padding: 0.5rem;">Show action buttons</td>
            </tr>
            <tr>
              <td style="padding: 0.5rem;"><code>compact</code></td>
              <td style="padding: 0.5rem;">boolean</td>
              <td style="padding: 0.5rem;">false</td>
              <td style="padding: 0.5rem;">Compact display mode</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="demo-section">
      <h2>Events</h2>
      <div class="demo-box">
        <table style="width: 100%; border-collapse: collapse;">
          <thead>
            <tr style="border-bottom: 1px solid var(--border);">
              <th style="text-align: left; padding: 0.5rem;">Event</th>
              <th style="text-align: left; padding: 0.5rem;">Detail</th>
              <th style="text-align: left; padding: 0.5rem;">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr style="border-bottom: 1px solid var(--border);">
              <td style="padding: 0.5rem;"><code>erxAction</code></td>
              <td style="padding: 0.5rem;">{ action, machine }</td>
              <td style="padding: 0.5rem;">Fired when action button clicked (start, stop, maintenance, details)</td>
            </tr>
            <tr>
              <td style="padding: 0.5rem;"><code>erxSelect</code></td>
              <td style="padding: 0.5rem;">Machine</td>
              <td style="padding: 0.5rem;">Fired when machine card is clicked</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <script>
    // Running machine with job
    const machine1 = {
      id: 'machine-001',
      name: 'CNC Mill #1',
      code: 'CNC-M1-001',
      image: 'https://via.placeholder.com/80x80/10b981/ffffff?text=CNC',
      state: 'running',
      efficiency: 94,
      currentJob: {
        id: 'job-1',
        name: 'Part A-2045 Machining',
        progress: 67,
        eta: '45 min'
      },
      metrics: [
        { label: 'Speed', value: 2400, unit: 'RPM', status: 'normal' },
        { label: 'Feed', value: 150, unit: 'mm/min', status: 'normal' },
        { label: 'Temp', value: 42, unit: '°C', status: 'normal' },
        { label: 'Load', value: 78, unit: '%', status: 'warning' }
      ],
      operator: {
        id: 'op-1',
        name: 'John Smith'
      },
      lastMaintenance: '2024-01-10',
      nextMaintenance: '2024-02-10'
    };

    // Machine with alerts
    const machine2 = {
      id: 'machine-002',
      name: 'Injection Molder #3',
      code: 'IM-003',
      state: 'running',
      efficiency: 72,
      currentJob: {
        id: 'job-2',
        name: 'Housing Part B-100',
        progress: 34,
        eta: '2h 15min'
      },
      metrics: [
        { label: 'Barrel Temp', value: 245, unit: '°C', status: 'warning' },
        { label: 'Pressure', value: 850, unit: 'bar', status: 'normal' },
        { label: 'Cycle Time', value: 28, unit: 's', status: 'normal' },
        { label: 'Scrap Rate', value: 3.5, unit: '%', status: 'critical' }
      ],
      alerts: [
        { id: 'a1', type: 'warning', message: 'Barrel temperature approaching upper limit', timestamp: '2024-01-18T10:30:00Z' },
        { id: 'a2', type: 'error', message: 'Scrap rate exceeds threshold (>3%)', timestamp: '2024-01-18T10:15:00Z' },
        { id: 'a3', type: 'info', message: 'Maintenance scheduled in 5 days', timestamp: '2024-01-18T08:00:00Z' }
      ],
      operator: {
        id: 'op-2',
        name: 'Maria Garcia'
      }
    };

    // Idle machine
    const machine3 = {
      id: 'machine-003',
      name: 'Laser Cutter #2',
      code: 'LC-002',
      state: 'idle',
      efficiency: 0,
      metrics: [
        { label: 'Power', value: 0, unit: 'W', status: 'normal' },
        { label: 'Temp', value: 22, unit: '°C', status: 'normal' },
        { label: 'Uptime', value: 98.5, unit: '%', status: 'normal' }
      ],
      lastMaintenance: '2024-01-15',
      nextMaintenance: '2024-02-15'
    };

    // Compact machines
    const machine4 = {
      id: 'machine-004',
      name: 'Press #1',
      code: 'PR-001',
      state: 'running',
      efficiency: 88,
      currentJob: { id: 'j4', name: 'Stamping Run', progress: 45 }
    };

    const machine5 = {
      id: 'machine-005',
      name: 'Welder #2',
      code: 'WLD-002',
      state: 'maintenance',
      efficiency: 0
    };

    const machine6 = {
      id: 'machine-006',
      name: 'Lathe #3',
      code: 'LTH-003',
      state: 'error',
      efficiency: 0,
      alerts: [
        { id: 'e1', type: 'error', message: 'Spindle motor fault', timestamp: '2024-01-18T09:00:00Z' }
      ]
    };

    const machine7 = {
      id: 'machine-007',
      name: 'Robot Arm #1',
      code: 'RA-001',
      state: 'offline',
      efficiency: 0
    };

    // Initialize components
    document.getElementById('machine1').machine = machine1;
    document.getElementById('machine2').machine = machine2;
    document.getElementById('machine3').machine = machine3;
    document.getElementById('machine4').machine = machine4;
    document.getElementById('machine5').machine = machine5;
    document.getElementById('machine6').machine = machine6;
    document.getElementById('machine7').machine = machine7;

    // Event listeners
    document.querySelectorAll('erx-machine-status').forEach(el => {
      el.addEventListener('erxAction', (e) => {
        console.log('Action:', e.detail.action, 'Machine:', e.detail.machine.name);
        alert(`Action: ${e.detail.action} on ${e.detail.machine.name}`);
      });
      el.addEventListener('erxSelect', (e) => {
        console.log('Selected machine:', e.detail.name);
      });
    });
  </script>
</body>
</html>
