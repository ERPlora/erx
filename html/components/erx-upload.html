<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>erx-upload - ERX Components</title>
  <script type="module" src="https://unpkg.com/@erplora/erx/dist/erx/erx.esm.js"></script>
  <script nomodule src="https://unpkg.com/@erplora/erx/dist/erx/erx.js"></script>
  <link rel="stylesheet" href="../styles.css">
</head>
<body>
  <div class="component-page" style="padding: 2rem;">
    <a href="../index.html" class="back-link">&larr; Back to Components</a>
    <div class="component-header">
      <h1>erx-upload</h1>
      <p>File upload component with drag-and-drop support, file previews, progress tracking, and validation.</p>
    </div>
    <div class="demo-section">
      <h2>Basic File Upload</h2>
      <div class="demo-box">
        <erx-upload id="basic-upload"></erx-upload>
      </div>
    </div>

    <div class="demo-section">
      <h2>Image Upload Only</h2>
      <div class="demo-box">
        <erx-upload
          id="image-upload"
          accept="image/*">
        </erx-upload>
        <p style="margin-top: 1rem; color: var(--text-muted); font-size: 0.875rem;">
          Only image files are accepted. Previews are shown for uploaded images.
        </p>
      </div>
    </div>

    <div class="demo-section">
      <h2>Document Upload</h2>
      <div class="demo-box">
        <erx-upload
          id="doc-upload"
          accept=".pdf,.doc,.docx,.xls,.xlsx">
        </erx-upload>
        <p style="margin-top: 1rem; color: var(--text-muted); font-size: 0.875rem;">
          Accepts PDF, Word, and Excel documents.
        </p>
      </div>
    </div>

    <div class="demo-section">
      <h2>Single File Upload</h2>
      <div class="demo-box">
        <erx-upload
          id="single-upload">
        </erx-upload>
      </div>
    </div>

    <div class="demo-section">
      <h2>Custom Limits</h2>
      <div class="demo-box">
        <erx-upload
          id="limited-upload">
        </erx-upload>
        <p style="margin-top: 1rem; color: var(--text-muted); font-size: 0.875rem;">
          Maximum 5 files, 2MB each.
        </p>
      </div>
    </div>

    <div class="demo-section">
      <h2>Without File List</h2>
      <div class="demo-box">
        <erx-upload
          id="no-list-upload">
        </erx-upload>
        <p style="margin-top: 1rem; color: var(--text-muted); font-size: 0.875rem;">
          File list is hidden. Use events to track selected files.
        </p>
      </div>
    </div>

    <div class="demo-section">
      <h2>Disabled State</h2>
      <div class="demo-box">
        <erx-upload
          id="disabled-upload"
          disabled>
        </erx-upload>
      </div>
    </div>

    <div class="demo-section">
      <h2>File Management</h2>
      <div class="demo-box">
        <erx-upload id="managed-upload"></erx-upload>
        <div style="margin-top: 1rem;">
          <button id="get-files-btn" style="padding: 0.5rem 1rem; background: var(--primary); color: white; border: none; border-radius: 6px; cursor: pointer; margin-right: 0.5rem;">
            Get Files
          </button>
          <button id="clear-files-btn" style="padding: 0.5rem 1rem; background: #ef4444; color: white; border: none; border-radius: 6px; cursor: pointer;">
            Clear All
          </button>
        </div>
        <div id="file-info" style="margin-top: 1rem; font-family: monospace; font-size: 0.875rem; color: var(--text-muted);">
          Upload files and click "Get Files" to see file info.
        </div>
      </div>
    </div>

    <div class="demo-section">
      <h2>Event Output</h2>
      <div class="demo-box">
        <div id="event-output" style="font-family: monospace; font-size: 0.875rem; color: var(--text-muted); white-space: pre-wrap;">
          Upload files to see the event details...
        </div>
      </div>
    </div>
  </div>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // Basic upload - using defaults

      // Single file upload
      const singleUpload = document.getElementById('single-upload');
      singleUpload.multiple = false;
      singleUpload.maxFiles = 1;

      // Limited upload
      const limitedUpload = document.getElementById('limited-upload');
      limitedUpload.maxFiles = 5;
      limitedUpload.maxSize = 2 * 1024 * 1024; // 2MB

      // No list upload
      const noListUpload = document.getElementById('no-list-upload');
      noListUpload.showList = false;

      // File management
      const managedUpload = document.getElementById('managed-upload');
      const getFilesBtn = document.getElementById('get-files-btn');
      const clearFilesBtn = document.getElementById('clear-files-btn');
      const fileInfo = document.getElementById('file-info');

      getFilesBtn.addEventListener('click', async () => {
        const files = await managedUpload.getFiles();
        if (files.length === 0) {
          fileInfo.textContent = 'No files uploaded.';
        } else {
          const info = files.map(f => ({
            name: f.name,
            size: `${(f.size / 1024).toFixed(1)} KB`,
            type: f.type,
            status: f.status
          }));
          fileInfo.innerHTML = `<strong>Files (${files.length}):</strong>\n${JSON.stringify(info, null, 2)}`;
        }
      });

      clearFilesBtn.addEventListener('click', async () => {
        await managedUpload.clearFiles();
        fileInfo.textContent = 'All files cleared.';
      });

      // Event handling
      const eventOutput = document.getElementById('event-output');
      document.querySelectorAll('erx-upload').forEach(upload => {
        upload.addEventListener('erxSelect', (e) => {
          const files = e.detail.files.map(f => ({
            name: f.name,
            size: `${(f.size / 1024).toFixed(1)} KB`,
            type: f.type
          }));
          eventOutput.innerHTML = `<strong>erxSelect:</strong>\n${JSON.stringify({ files }, null, 2)}`;
        });

        upload.addEventListener('erxRemove', (e) => {
          eventOutput.innerHTML = `<strong>erxRemove:</strong>\n${JSON.stringify({
            name: e.detail.file.name,
            id: e.detail.file.id
          }, null, 2)}`;
        });
      });
    });
  </script>
</body>
</html>
