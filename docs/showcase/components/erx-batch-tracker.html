<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>erx-batch-tracker - ERX Components</title>
  <script type="module" src="https://unpkg.com/@erplora/erx/dist/erx/erx.esm.js"></script>
  <script nomodule src="https://unpkg.com/@erplora/erx/dist/erx/erx.js"></script>
  <link rel="stylesheet" href="../styles.css">
</head>
<body>
  <div class="component-page" style="padding: 2rem;">
    <a href="../index.html" class="back-link">&larr; Back to Components</a>
    <div class="component-header">
      <h1>erx-batch-tracker</h1>
      <p>Batch tracking component showing production stages, quantities, yield rates, and full traceability timeline.</p>
    </div>

    <div class="demo-section">
      <h2>In Production Batch</h2>
      <div class="demo-box">
        <erx-batch-tracker id="batch1"></erx-batch-tracker>
      </div>
    </div>

    <div class="demo-section">
      <h2>Completed Batch with Timeline</h2>
      <div class="demo-box">
        <erx-batch-tracker id="batch2" show-timeline></erx-batch-tracker>
      </div>
    </div>

    <div class="demo-section">
      <h2>Quality Check Batch</h2>
      <div class="demo-box">
        <erx-batch-tracker id="batch3"></erx-batch-tracker>
      </div>
    </div>

    <div class="demo-section">
      <h2>Compact Mode</h2>
      <div class="demo-box">
        <div class="demo-row">
          <erx-batch-tracker id="batch4" compact></erx-batch-tracker>
          <erx-batch-tracker id="batch5" compact></erx-batch-tracker>
        </div>
      </div>
    </div>

    <div class="demo-section">
      <h2>Properties</h2>
      <div class="demo-box">
        <table style="width: 100%; border-collapse: collapse;">
          <thead>
            <tr style="border-bottom: 1px solid var(--border);">
              <th style="text-align: left; padding: 0.5rem;">Property</th>
              <th style="text-align: left; padding: 0.5rem;">Type</th>
              <th style="text-align: left; padding: 0.5rem;">Default</th>
              <th style="text-align: left; padding: 0.5rem;">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr style="border-bottom: 1px solid var(--border);">
              <td style="padding: 0.5rem;"><code>batch</code></td>
              <td style="padding: 0.5rem;">Batch</td>
              <td style="padding: 0.5rem;">-</td>
              <td style="padding: 0.5rem;">Batch data object (required)</td>
            </tr>
            <tr style="border-bottom: 1px solid var(--border);">
              <td style="padding: 0.5rem;"><code>show-timeline</code></td>
              <td style="padding: 0.5rem;">boolean</td>
              <td style="padding: 0.5rem;">true</td>
              <td style="padding: 0.5rem;">Show event history timeline</td>
            </tr>
            <tr style="border-bottom: 1px solid var(--border);">
              <td style="padding: 0.5rem;"><code>show-qr</code></td>
              <td style="padding: 0.5rem;">boolean</td>
              <td style="padding: 0.5rem;">false</td>
              <td style="padding: 0.5rem;">Display QR code for traceability</td>
            </tr>
            <tr>
              <td style="padding: 0.5rem;"><code>compact</code></td>
              <td style="padding: 0.5rem;">boolean</td>
              <td style="padding: 0.5rem;">false</td>
              <td style="padding: 0.5rem;">Compact display mode</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="demo-section">
      <h2>Events</h2>
      <div class="demo-box">
        <table style="width: 100%; border-collapse: collapse;">
          <thead>
            <tr style="border-bottom: 1px solid var(--border);">
              <th style="text-align: left; padding: 0.5rem;">Event</th>
              <th style="text-align: left; padding: 0.5rem;">Detail</th>
              <th style="text-align: left; padding: 0.5rem;">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr style="border-bottom: 1px solid var(--border);">
              <td style="padding: 0.5rem;"><code>erxSelect</code></td>
              <td style="padding: 0.5rem;">{ batch }</td>
              <td style="padding: 0.5rem;">Fired when batch card is clicked</td>
            </tr>
            <tr>
              <td style="padding: 0.5rem;"><code>erxStageSelect</code></td>
              <td style="padding: 0.5rem;">BatchStage</td>
              <td style="padding: 0.5rem;">Fired when a production stage is clicked</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <script>
    // In production batch
    const batch1 = {
      id: 'batch-001',
      number: 'BATCH-2024-0089',
      product: {
        id: 'prod-1',
        name: 'Premium Widget Assembly',
        sku: 'PWA-100',
        image: 'https://via.placeholder.com/60x60/6366f1/ffffff?text=PWA'
      },
      quantity: 500,
      quantityGood: 312,
      quantityDefect: 8,
      unit: 'units',
      status: 'in-production',
      manufactureDate: '2024-01-15',
      expiryDate: '2026-01-15',
      location: 'Warehouse A, Rack 12',
      stages: [
        { id: 's1', name: 'Material Prep', status: 'completed', completedAt: '2024-01-15T08:30:00Z' },
        { id: 's2', name: 'Assembly', status: 'completed', completedAt: '2024-01-16T14:00:00Z' },
        { id: 's3', name: 'Welding', status: 'current' },
        { id: 's4', name: 'Quality Check', status: 'pending' },
        { id: 's5', name: 'Packaging', status: 'pending' }
      ],
      events: [
        { id: 'e1', type: 'created', description: 'Batch created', timestamp: '2024-01-15T07:00:00Z', user: { id: 'u1', name: 'John Smith' } },
        { id: 'e2', type: 'started', description: 'Production started', timestamp: '2024-01-15T08:00:00Z', user: { id: 'u1', name: 'John Smith' } },
        { id: 'e3', type: 'stage-change', description: 'Material Prep completed', timestamp: '2024-01-15T08:30:00Z', user: { id: 'u2', name: 'Alice Chen' } },
        { id: 'e4', type: 'stage-change', description: 'Assembly completed', timestamp: '2024-01-16T14:00:00Z', user: { id: 'u3', name: 'Bob Wilson' } },
        { id: 'e5', type: 'note', description: '8 units rejected due to surface defects', timestamp: '2024-01-16T16:00:00Z', user: { id: 'u4', name: 'QC Team' } }
      ],
      workOrder: { id: 'wo-001', number: 'WO-2024-001' }
    };

    // Completed batch
    const batch2 = {
      id: 'batch-002',
      number: 'BATCH-2024-0085',
      product: {
        id: 'prod-2',
        name: 'Motor Assembly M500',
        sku: 'MA-500'
      },
      quantity: 200,
      quantityGood: 196,
      quantityDefect: 4,
      unit: 'units',
      status: 'completed',
      manufactureDate: '2024-01-10',
      expiryDate: '2029-01-10',
      location: 'Finished Goods, Bay 5',
      stages: [
        { id: 's1', name: 'Component Assembly', status: 'completed', completedAt: '2024-01-10T12:00:00Z' },
        { id: 's2', name: 'Motor Winding', status: 'completed', completedAt: '2024-01-11T10:00:00Z' },
        { id: 's3', name: 'Testing', status: 'completed', completedAt: '2024-01-11T16:00:00Z' },
        { id: 's4', name: 'Final QC', status: 'completed', completedAt: '2024-01-12T09:00:00Z' }
      ],
      events: [
        { id: 'e1', type: 'created', description: 'Batch created from WO-2024-003', timestamp: '2024-01-10T07:00:00Z', user: { id: 'u1', name: 'System' } },
        { id: 'e2', type: 'started', description: 'Production started', timestamp: '2024-01-10T08:00:00Z' },
        { id: 'e3', type: 'stage-change', description: 'Component Assembly completed', timestamp: '2024-01-10T12:00:00Z' },
        { id: 'e4', type: 'stage-change', description: 'Motor Winding completed', timestamp: '2024-01-11T10:00:00Z' },
        { id: 'e5', type: 'quality', description: '4 units failed noise test', timestamp: '2024-01-11T15:00:00Z' },
        { id: 'e6', type: 'stage-change', description: 'Testing completed', timestamp: '2024-01-11T16:00:00Z' },
        { id: 'e7', type: 'completed', description: 'Batch completed - 98% yield', timestamp: '2024-01-12T09:00:00Z' }
      ]
    };

    // Quality check batch
    const batch3 = {
      id: 'batch-003',
      number: 'BATCH-2024-0090',
      product: {
        id: 'prod-3',
        name: 'Circuit Board PCB-X1',
        sku: 'PCB-X1'
      },
      quantity: 1000,
      quantityGood: 978,
      quantityDefect: 22,
      unit: 'pcs',
      status: 'quality-check',
      manufactureDate: '2024-01-17',
      stages: [
        { id: 's1', name: 'SMT Assembly', status: 'completed', completedAt: '2024-01-17T12:00:00Z' },
        { id: 's2', name: 'Reflow', status: 'completed', completedAt: '2024-01-17T14:00:00Z' },
        { id: 's3', name: 'Through-hole', status: 'completed', completedAt: '2024-01-17T16:00:00Z' },
        { id: 's4', name: 'AOI Inspection', status: 'current' },
        { id: 's5', name: 'Functional Test', status: 'pending' }
      ]
    };

    // Compact batches
    const batch4 = {
      id: 'batch-004',
      number: 'BATCH-2024-0091',
      product: { id: 'p4', name: 'Gear Set GS-100', sku: 'GS-100' },
      quantity: 300,
      quantityGood: 300,
      quantityDefect: 0,
      unit: 'sets',
      status: 'shipped'
    };

    const batch5 = {
      id: 'batch-005',
      number: 'BATCH-2024-0092',
      product: { id: 'p5', name: 'Bearing Pack BP-50', sku: 'BP-50' },
      quantity: 500,
      quantityGood: 0,
      quantityDefect: 0,
      unit: 'packs',
      status: 'created'
    };

    // Initialize components
    document.getElementById('batch1').batch = batch1;
    document.getElementById('batch2').batch = batch2;
    document.getElementById('batch3').batch = batch3;
    document.getElementById('batch4').batch = batch4;
    document.getElementById('batch5').batch = batch5;

    // Event listeners
    document.querySelectorAll('erx-batch-tracker').forEach(el => {
      el.addEventListener('erxSelect', (e) => {
        console.log('Batch selected:', e.detail.batch.number);
        alert(`Selected batch: ${e.detail.batch.number} (${e.detail.batch.status})`);
      });
      el.addEventListener('erxStageSelect', (e) => {
        console.log('Stage selected:', e.detail.name);
        alert(`Stage: ${e.detail.name} - ${e.detail.status}`);
      });
    });
  </script>
</body>
</html>
