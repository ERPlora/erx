import{r as x,c as n,g as p,h as a}from"./index-DLMfuaWg.js";const f=()=>`:host{display:block;font-family:-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif}.erx-grid{display:flex;flex-direction:column;background:var(--erx-surface, #ffffff);border:1px solid var(--erx-border-color, #e5e7eb);border-radius:var(--erx-border-radius, 8px);overflow:hidden}.erx-grid__header{flex-shrink:0;background:var(--erx-surface-secondary, #f9fafb);border-bottom:1px solid var(--erx-border-color, #e5e7eb)}.erx-grid__body{flex:1;overflow:auto}.erx-grid__row{display:flex;align-items:center;border-bottom:1px solid var(--erx-border-color, #e5e7eb);transition:background-color 150ms ease}.erx-grid__row:last-child{border-bottom:none}.erx-grid__row--header{font-weight:600;color:var(--erx-text, #111827);-webkit-user-select:none;-moz-user-select:none;user-select:none}.erx-grid__row--filter{padding:var(--erx-space-xs, 4px) 0;background:var(--erx-surface-tertiary, #f3f4f6)}:host([hover]) .erx-grid__row:not(.erx-grid__row--header):not(.erx-grid__row--filter):hover{background:var(--erx-surface-secondary, #f9fafb)}:host([striped]) .erx-grid__row--odd{background:var(--erx-surface-secondary, #f9fafb)}.erx-grid__row--selected{background:rgba(var(--erx-color-primary-rgb, 102, 126, 234), 0.1) !important}:host([bordered]) .erx-grid__cell{border-right:1px solid var(--erx-border-color, #e5e7eb)}:host([bordered]) .erx-grid__cell:last-child{border-right:none}:host([compact]) .erx-grid__row{height:36px !important}:host([compact]) .erx-grid__cell{padding:var(--erx-space-xs, 4px) var(--erx-space-sm, 8px)}.erx-grid__cell{flex:1 1 0;min-width:0;padding:var(--erx-space-sm, 8px) var(--erx-space-md, 16px);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.erx-grid__cell--checkbox{flex:0 0 48px;display:flex;align-items:center;justify-content:center}.erx-grid__cell--checkbox input[type="checkbox"]{width:18px;height:18px;cursor:pointer;accent-color:var(--erx-color-primary, #667eea)}.erx-grid__cell--align-left{text-align:left}.erx-grid__cell--align-center{text-align:center}.erx-grid__cell--align-right{text-align:right}.erx-grid__cell--sortable{cursor:pointer}.erx-grid__cell--sortable:hover{background:var(--erx-surface-tertiary, #f3f4f6)}.erx-grid__cell--sorted{color:var(--erx-color-primary, #667eea)}.erx-grid__header-text{flex:1}.erx-grid__sort-icon{margin-left:var(--erx-space-sm, 8px);font-size:10px;opacity:0.7}.erx-grid__cell--editable{cursor:pointer}.erx-grid__cell--editable:hover{background:rgba(var(--erx-color-primary-rgb, 102, 126, 234), 0.05)}.erx-grid__cell--editing{padding:var(--erx-space-xs, 4px)}.erx-grid__edit-input{width:100%;height:100%;padding:var(--erx-space-xs, 4px) var(--erx-space-sm, 8px);border:2px solid var(--erx-color-primary, #667eea);border-radius:var(--erx-border-radius-sm, 4px);font-size:inherit;font-family:inherit;outline:none;background:var(--erx-surface, #ffffff);color:var(--erx-text, #111827)}.erx-grid__filter-input{width:100%;padding:var(--erx-space-xs, 4px) var(--erx-space-sm, 8px);border:1px solid var(--erx-border-color, #e5e7eb);border-radius:var(--erx-border-radius-sm, 4px);font-size:13px;background:var(--erx-surface, #ffffff);color:var(--erx-text, #111827)}.erx-grid__filter-input:focus{outline:none;border-color:var(--erx-color-primary, #667eea);box-shadow:0 0 0 2px rgba(var(--erx-color-primary-rgb, 102, 126, 234), 0.2)}.erx-grid__boolean{display:inline-block;padding:2px 8px;border-radius:4px;font-size:12px;font-weight:500}.erx-grid__boolean--true{background:rgba(34, 197, 94, 0.1);color:#16a34a}.erx-grid__boolean--false{background:rgba(239, 68, 68, 0.1);color:#dc2626}.erx-grid__loading{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:var(--erx-space-xl, 32px);color:var(--erx-text-secondary, #6b7280)}.erx-grid__spinner{width:32px;height:32px;border:3px solid var(--erx-border-color, #e5e7eb);border-top-color:var(--erx-color-primary, #667eea);border-radius:50%;animation:erx-spin 0.8s linear infinite;margin-bottom:var(--erx-space-sm, 8px)}@keyframes erx-spin{to{transform:rotate(360deg)}}.erx-grid__empty{display:flex;align-items:center;justify-content:center;padding:var(--erx-space-xl, 32px);color:var(--erx-text-secondary, #6b7280);text-align:center}.erx-grid__pagination{display:flex;align-items:center;justify-content:space-between;padding:var(--erx-space-sm, 8px) var(--erx-space-md, 16px);background:var(--erx-surface-secondary, #f9fafb);border-top:1px solid var(--erx-border-color, #e5e7eb);font-size:14px}.erx-grid__pagination-info{color:var(--erx-text-secondary, #6b7280)}.erx-grid__pagination-controls{display:flex;align-items:center;gap:var(--erx-space-xs, 4px)}.erx-grid__pagination-btn{display:flex;align-items:center;justify-content:center;width:32px;height:32px;border:1px solid var(--erx-border-color, #e5e7eb);border-radius:var(--erx-border-radius-sm, 4px);background:var(--erx-surface, #ffffff);color:var(--erx-text, #111827);cursor:pointer;transition:all 150ms ease}.erx-grid__pagination-btn:hover:not(:disabled){background:var(--erx-surface-tertiary, #f3f4f6);border-color:var(--erx-color-primary, #667eea)}.erx-grid__pagination-btn:disabled{opacity:0.5;cursor:not-allowed}.erx-grid__pagination-current{padding:0 var(--erx-space-sm, 8px);color:var(--erx-text, #111827)}@media (prefers-color-scheme: dark){:host{color-scheme:dark}}:host-context(.dark) .erx-grid,:host(.dark) .erx-grid{background:var(--erx-surface);color:var(--erx-text)}:host-context(.dark) .erx-grid__header,:host(.dark) .erx-grid__header{background:var(--erx-surface-secondary)}:host-context(.dark) .erx-grid__edit-input,:host-context(.dark) .erx-grid__filter-input,:host(.dark) .erx-grid__edit-input,:host(.dark) .erx-grid__filter-input{background:var(--erx-surface-tertiary);color:var(--erx-text);border-color:var(--erx-border-color)}:host-context(.dark) .erx-grid__pagination-btn,:host(.dark) .erx-grid__pagination-btn{background:var(--erx-surface-tertiary);color:var(--erx-text);border-color:var(--erx-border-color)}`,u=class{constructor(t){x(this,t),this.erxSort=n(this,"erxSort"),this.erxFilter=n(this,"erxFilter"),this.erxRowSelect=n(this,"erxRowSelect"),this.erxRowClick=n(this,"erxRowClick"),this.erxRowDoubleClick=n(this,"erxRowDoubleClick"),this.erxCellEdit=n(this,"erxCellEdit"),this.erxCellEditStart=n(this,"erxCellEditStart"),this.erxCellEditCancel=n(this,"erxCellEditCancel"),this.erxPageChange=n(this,"erxPageChange")}get el(){return p(this)}data=[];columns=[];selectable=!1;selected=[];rowKey="id";sortable=!0;filterable=!1;editable=!1;groupBy;virtualScroll=!1;rowHeight=48;visibleRows=15;loading=!1;emptyMessage="No data available";striped=!1;hover=!0;bordered=!1;compact=!1;paginate=!1;pageSize=25;currentPage=1;totalRows;sortState=null;filterState={};expandedGroups=new Set;editingCell=null;editValue="";scrollTop=0;processedData=[];tableBodyRef;erxSort;erxFilter;erxRowSelect;erxRowClick;erxRowDoubleClick;erxCellEdit;erxCellEditStart;erxCellEditCancel;erxPageChange;handleDataChange(){this.processData()}componentWillLoad(){this.processData()}async selectAll(){this.selectable==="multiple"&&(this.selected=this.processedData.map(t=>String(t[this.rowKey])),this.emitRowSelect())}async clearSelection(){this.selected=[],this.emitRowSelect()}async exportToCSV(t="export.csv"){const e=this.columns.filter(c=>!c.hidden),r=e.map(c=>c.header).join(","),i=this.processedData.map(c=>e.map(h=>{const g=c[h.field];return`"${(h.formatter?h.formatter(g,c):String(g??"")).replace(/"/g,'""')}"`}).join(",")),l=[r,...i].join(`
`),s=new Blob([l],{type:"text/csv;charset=utf-8;"}),d=URL.createObjectURL(s),o=document.createElement("a");return o.href=d,o.download=t,o.click(),URL.revokeObjectURL(d),l}async scrollToRow(t){const e=this.processedData.findIndex(r=>String(r[this.rowKey])===t);if(e>=0&&this.tableBodyRef){const r=e*this.rowHeight;this.tableBodyRef.scrollTop=r}}async refresh(){this.processData()}processData(){let t=[...this.data];if(Object.keys(this.filterState).length>0&&(t=this.applyFilters(t)),this.sortState&&(t=this.applySort(t)),this.groupBy&&(t=this.applyGrouping(t)),this.paginate&&!this.totalRows){const e=(this.currentPage-1)*this.pageSize;t=t.slice(e,e+this.pageSize)}this.processedData=t}applyFilters(t){return t.filter(e=>Object.entries(this.filterState).every(([r,i])=>{if(!i.value)return!0;const l=String(e[r]??"").toLowerCase(),s=String(i.value).toLowerCase();switch(i.operator){case"equals":return l===s;case"startsWith":return l.startsWith(s);case"endsWith":return l.endsWith(s);case"gt":return Number(e[r])>Number(i.value);case"lt":return Number(e[r])<Number(i.value);case"gte":return Number(e[r])>=Number(i.value);case"lte":return Number(e[r])<=Number(i.value);default:return l.includes(s)}}))}applySort(t){if(!this.sortState)return t;const{field:e,direction:r}=this.sortState;return[...t].sort((i,l)=>{const s=i[e],d=l[e];if(s==null&&d==null)return 0;if(s==null)return r==="asc"?-1:1;if(d==null)return r==="asc"?1:-1;let o=0;return typeof s=="number"&&typeof d=="number"?o=s-d:o=String(s).localeCompare(String(d)),r==="desc"?-o:o})}applyGrouping(t){return t}handleSort(t){if(!t.sortable||!this.sortable)return;let e="asc";this.sortState?.field===t.field&&(this.sortState.direction==="asc"?e="desc":e=null),this.sortState=e?{field:t.field,direction:e}:null,this.erxSort.emit({field:t.field,direction:e,sortState:this.sortState})}handleRowClick(t,e,r){if(this.erxRowClick.emit({row:t,index:e,originalEvent:r}),this.selectable){const i=String(t[this.rowKey]);if(this.selectable==="single")this.selected=[i];else if(this.selectable==="multiple")if(r.ctrlKey||r.metaKey)this.selected=this.selected.includes(i)?this.selected.filter(l=>l!==i):[...this.selected,i];else if(r.shiftKey&&this.selected.length>0){const l=this.selected[this.selected.length-1],s=this.processedData.findIndex(h=>String(h[this.rowKey])===l),d=Math.min(s,e),o=Math.max(s,e),c=this.processedData.slice(d,o+1).map(h=>String(h[this.rowKey]));this.selected=[...new Set([...this.selected,...c])]}else this.selected=[i];this.emitRowSelect(t,i)}}handleRowDoubleClick(t,e,r){this.erxRowDoubleClick.emit({row:t,index:e,originalEvent:r})}emitRowSelect(t,e){this.erxRowSelect.emit({selectedRows:this.data.filter(r=>this.selected.includes(String(r[this.rowKey]))),selectedKeys:this.selected,row:t,key:e})}handleCheckboxChange(t,e){e?this.selected=[...this.selected,t]:this.selected=this.selected.filter(r=>r!==t),this.emitRowSelect()}handleSelectAllChange(t){t?this.selected=this.processedData.map(e=>String(e[this.rowKey])):this.selected=[],this.emitRowSelect()}startEdit(t,e){if(!this.editable||!e.editable)return;const r=String(t[this.rowKey]);this.editingCell={rowKey:r,field:e.field},this.editValue=String(t[e.field]??""),this.erxCellEditStart.emit({row:t,field:e.field,rowKey:r})}commitEdit(t,e){if(!this.editingCell)return;const r=t[e.field];let i=this.editValue;e.type==="number"||e.type==="currency"?i=parseFloat(this.editValue)||0:e.type==="boolean"&&(i=this.editValue==="true"),this.erxCellEdit.emit({row:t,field:e.field,oldValue:r,newValue:i,rowKey:this.editingCell.rowKey}),this.editingCell=null,this.editValue=""}cancelEdit(){if(!this.editingCell)return;const t=this.data.find(e=>String(e[this.rowKey])===this.editingCell.rowKey);t&&this.erxCellEditCancel.emit({row:t,field:this.editingCell.field,rowKey:this.editingCell.rowKey}),this.editingCell=null,this.editValue=""}handleFilterChange(t,e){if(e)this.filterState={...this.filterState,[t]:{value:e,operator:"contains"}};else{const r={...this.filterState};delete r[t],this.filterState=r}this.erxFilter.emit({filters:this.filterState})}handlePageChange(t){this.currentPage=t,this.erxPageChange.emit({page:t,pageSize:this.pageSize,total:this.totalRows??this.data.length})}getVisibleColumns(){return this.columns.filter(t=>!t.hidden)}getTotalPages(){const t=this.totalRows??this.data.length;return Math.ceil(t/this.pageSize)}formatCellValue(t,e,r){if(e.formatter)return e.formatter(t,r);if(t==null)return"";switch(e.type){case"currency":return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(Number(t));case"number":return new Intl.NumberFormat("en-US").format(Number(t));case"date":return new Date(t).toLocaleDateString();case"boolean":return t?"Yes":"No";default:return String(t)}}renderHeader(){const t=this.getVisibleColumns(),e=this.processedData.length>0&&this.processedData.every(i=>this.selected.includes(String(i[this.rowKey]))),r=this.selected.length>0&&this.processedData.some(i=>this.selected.includes(String(i[this.rowKey])));return a("div",{class:"erx-grid__header",part:"header"},a("div",{class:"erx-grid__row erx-grid__row--header"},this.selectable==="multiple"&&a("div",{class:"erx-grid__cell erx-grid__cell--checkbox"},a("input",{type:"checkbox",checked:e,indeterminate:r&&!e,onChange:i=>this.handleSelectAllChange(i.target.checked),"aria-label":"Select all rows"})),t.map(i=>a("div",{class:{"erx-grid__cell":!0,"erx-grid__cell--header":!0,"erx-grid__cell--sortable":!!i.sortable&&this.sortable,"erx-grid__cell--sorted":this.sortState?.field===i.field,[`erx-grid__cell--align-${i.align||"left"}`]:!0,[i.headerClass||""]:!!i.headerClass},style:{width:i.width?typeof i.width=="number"?`${i.width}px`:i.width:void 0,minWidth:i.minWidth?`${i.minWidth}px`:void 0},onClick:()=>this.handleSort(i),part:"header-cell"},a("span",{class:"erx-grid__header-text"},i.header),i.sortable&&this.sortable&&this.sortState?.field===i.field&&a("span",{class:"erx-grid__sort-icon","aria-hidden":"true"},this.sortState.direction==="asc"?"▲":"▼")))),this.filterable&&this.renderFilterRow(t))}renderFilterRow(t){return a("div",{class:"erx-grid__row erx-grid__row--filter"},this.selectable==="multiple"&&a("div",{class:"erx-grid__cell erx-grid__cell--checkbox"}),t.map(e=>a("div",{class:"erx-grid__cell erx-grid__cell--filter",style:{width:e.width?typeof e.width=="number"?`${e.width}px`:e.width:void 0}},e.filterable!==!1&&a("input",{type:"text",class:"erx-grid__filter-input",placeholder:`Filter ${e.header}...`,value:this.filterState[e.field]?.value??"",onInput:r=>this.handleFilterChange(e.field,r.target.value)}))))}renderBody(){if(this.loading)return a("div",{class:"erx-grid__loading",part:"loading"},a("slot",{name:"loading"},a("div",{class:"erx-grid__spinner"}),a("span",null,"Loading...")));if(this.processedData.length===0)return a("div",{class:"erx-grid__empty",part:"empty"},a("slot",{name:"empty"},this.emptyMessage));const t=this.getVisibleColumns();return a("div",{class:"erx-grid__body",part:"body",ref:e=>this.tableBodyRef=e,style:{maxHeight:this.virtualScroll?`${this.visibleRows*this.rowHeight}px`:void 0}},this.processedData.map((e,r)=>this.renderRow(e,r,t)))}renderRow(t,e,r){const i=String(t[this.rowKey]),l=this.selected.includes(i);return a("div",{class:{"erx-grid__row":!0,"erx-grid__row--selected":l,"erx-grid__row--even":e%2===0,"erx-grid__row--odd":e%2!==0},style:{height:`${this.rowHeight}px`},onClick:s=>this.handleRowClick(t,e,s),onDblClick:s=>this.handleRowDoubleClick(t,e,s),part:"row",role:"row","aria-selected":l},this.selectable==="multiple"&&a("div",{class:"erx-grid__cell erx-grid__cell--checkbox"},a("input",{type:"checkbox",checked:l,onClick:s=>s.stopPropagation(),onChange:s=>this.handleCheckboxChange(i,s.target.checked),"aria-label":`Select row ${e+1}`})),r.map(s=>this.renderCell(t,s,i)))}renderCell(t,e,r){const i=t[e.field];if(this.editingCell?.rowKey===r&&this.editingCell?.field===e.field)return this.renderEditCell(t,e);const s=this.formatCellValue(i,e,t);return a("div",{class:{"erx-grid__cell":!0,"erx-grid__cell--editable":!!e.editable&&this.editable,[`erx-grid__cell--align-${e.align||"left"}`]:!0,[e.cellClass||""]:!!e.cellClass},style:{width:e.width?typeof e.width=="number"?`${e.width}px`:e.width:void 0,minWidth:e.minWidth?`${e.minWidth}px`:void 0},onDblClick:d=>{d.stopPropagation(),this.startEdit(t,e)},part:"cell",role:"gridcell"},e.type==="boolean"?a("span",{class:`erx-grid__boolean ${i?"erx-grid__boolean--true":"erx-grid__boolean--false"}`},s):s)}renderEditCell(t,e){return a("div",{class:"erx-grid__cell erx-grid__cell--editing",style:{width:e.width?typeof e.width=="number"?`${e.width}px`:e.width:void 0},part:"cell-editing"},e.editor==="select"&&e.editorOptions?a("select",{class:"erx-grid__edit-input",onChange:r=>{this.editValue=r.target.value},onBlur:()=>this.commitEdit(t,e),onKeyDown:r=>{r.key==="Enter"&&this.commitEdit(t,e),r.key==="Escape"&&this.cancelEdit()},ref:r=>{r&&(r.value=this.editValue,r.focus())}},e.editorOptions.map(r=>a("option",{value:String(r.value),selected:String(r.value)===this.editValue},r.label))):e.editor==="checkbox"||e.type==="boolean"?a("input",{type:"checkbox",checked:this.editValue==="true",onChange:r=>{this.editValue=r.target.checked?"true":"false",this.commitEdit(t,e)},onKeyDown:r=>{r.key==="Escape"&&this.cancelEdit()},ref:r=>r?.focus()}):a("input",{type:e.type==="number"||e.type==="currency"?"number":"text",class:"erx-grid__edit-input",value:this.editValue,onInput:r=>{this.editValue=r.target.value},onBlur:()=>this.commitEdit(t,e),onKeyDown:r=>{r.key==="Enter"&&this.commitEdit(t,e),r.key==="Escape"&&this.cancelEdit()},ref:r=>r?.focus()}))}renderPagination(){if(!this.paginate)return null;const t=this.getTotalPages(),e=this.totalRows??this.data.length;return a("div",{class:"erx-grid__pagination",part:"pagination"},a("span",{class:"erx-grid__pagination-info"},"Showing ",(this.currentPage-1)*this.pageSize+1," to"," ",Math.min(this.currentPage*this.pageSize,e)," of ",e),a("div",{class:"erx-grid__pagination-controls"},a("button",{class:"erx-grid__pagination-btn",disabled:this.currentPage===1,onClick:()=>this.handlePageChange(1),"aria-label":"First page"},"««"),a("button",{class:"erx-grid__pagination-btn",disabled:this.currentPage===1,onClick:()=>this.handlePageChange(this.currentPage-1),"aria-label":"Previous page"},"«"),a("span",{class:"erx-grid__pagination-current"},"Page ",this.currentPage," of ",t),a("button",{class:"erx-grid__pagination-btn",disabled:this.currentPage===t,onClick:()=>this.handlePageChange(this.currentPage+1),"aria-label":"Next page"},"»"),a("button",{class:"erx-grid__pagination-btn",disabled:this.currentPage===t,onClick:()=>this.handlePageChange(t),"aria-label":"Last page"},"»»")))}render(){return a("div",{key:"4749c5179b36367047c2dc563451ab54c7dd60ac",class:{"erx-grid":!0,"erx-grid--loading":this.loading,"erx-grid--striped":this.striped,"erx-grid--hover":this.hover,"erx-grid--bordered":this.bordered,"erx-grid--compact":this.compact},part:"container",role:"grid","aria-busy":this.loading},a("slot",{key:"9e13bdd8fa00f708b4fe36973ff378222e14a6ce",name:"toolbar"}),this.renderHeader(),this.renderBody(),this.renderPagination(),a("slot",{key:"2a08278132455f21189fe4ab947ca8924a74402e",name:"footer"}))}static get watchers(){return{data:[{handleDataChange:0}],sortState:[{handleDataChange:0}],filterState:[{handleDataChange:0}],groupBy:[{handleDataChange:0}],currentPage:[{handleDataChange:0}],pageSize:[{handleDataChange:0}]}}};u.style=f();export{u as erx_data_grid};
