import{r as c,c as d,g as x,h as n}from"./index-DLMfuaWg.js";const l=()=>":host{font-family:-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif}.erx-ctx{position:fixed;z-index:9999;min-width:180px;background:var(--erx-surface, #fff);border:1px solid var(--erx-border-color, #e5e7eb);border-radius:8px;box-shadow:0 4px 16px rgba(0,0,0,0.15);padding:4px 0}.erx-ctx__item-wrapper{position:relative}.erx-ctx__item{display:flex;align-items:center;gap:12px;width:100%;padding:10px 16px;border:none;background:transparent;font-size:14px;color:var(--erx-text, #111827);text-align:left;cursor:pointer;transition:background 150ms ease}.erx-ctx__item:hover:not(:disabled){background:var(--erx-surface-secondary, #f9fafb)}.erx-ctx__item--focused{background:var(--erx-surface-secondary, #f9fafb)}.erx-ctx__item--disabled{opacity:0.5;cursor:not-allowed}.erx-ctx__item--danger{color:var(--erx-color-danger, #ef4444)}.erx-ctx__item--danger:hover:not(:disabled){background:rgba(239,68,68,0.1)}.erx-ctx__icon{font-size:16px;flex-shrink:0;width:20px;text-align:center}.erx-ctx__label{flex:1}.erx-ctx__shortcut{font-size:12px;color:var(--erx-text-tertiary, #9ca3af);padding:2px 6px;background:var(--erx-surface-secondary, #f9fafb);border-radius:4px}.erx-ctx__arrow{font-size:10px;color:var(--erx-text-tertiary, #9ca3af)}.erx-ctx__divider{height:1px;margin:4px 0;background:var(--erx-border-color, #e5e7eb)}.erx-ctx__header{padding:8px 16px;font-size:11px;font-weight:600;color:var(--erx-text-tertiary, #9ca3af);text-transform:uppercase;letter-spacing:0.5px}.erx-ctx__submenu{position:absolute;left:100%;top:0;margin-left:4px;min-width:160px;background:var(--erx-surface, #fff);border:1px solid var(--erx-border-color, #e5e7eb);border-radius:8px;box-shadow:0 4px 16px rgba(0,0,0,0.15);padding:4px 0}@media (prefers-color-scheme: dark){:host{color-scheme:dark}}:host-context(.dark) .erx-ctx,:host(.dark) .erx-ctx{background:var(--erx-surface);border-color:var(--erx-border-color)}:host-context(.dark) .erx-ctx__item,:host(.dark) .erx-ctx__item{color:var(--erx-text)}:host-context(.dark) .erx-ctx__shortcut,:host(.dark) .erx-ctx__shortcut{background:var(--erx-surface-secondary)}:host-context(.dark) .erx-ctx__submenu,:host(.dark) .erx-ctx__submenu{background:var(--erx-surface);border-color:var(--erx-border-color)}",h=class{constructor(e){c(this,e),this.erxSelect=d(this,"erxSelect"),this.erxOpenChange=d(this,"erxOpenChange")}get el(){return x(this)}items=[];target;disabled=!1;erxSelect;erxOpenChange;open=!1;position={x:0,y:0};focusedIndex=-1;submenuOpen=null;targetElement=null;componentDidLoad(){this.target?document.querySelectorAll(this.target).forEach(e=>{e.addEventListener("contextmenu",this.handleContextMenu)}):this.el.parentElement?.addEventListener("contextmenu",this.handleContextMenu)}disconnectedCallback(){this.target?document.querySelectorAll(this.target).forEach(e=>{e.removeEventListener("contextmenu",this.handleContextMenu)}):this.el.parentElement?.removeEventListener("contextmenu",this.handleContextMenu)}handleDocumentClick(e){this.open&&!this.el.contains(e.target)&&this.close()}handleKeyDown(e){if(!this.open)return;const t=this.items.filter(r=>r.type!=="divider"&&r.type!=="header"&&!r.disabled);switch(e.key){case"Escape":e.preventDefault(),this.close();break;case"ArrowDown":e.preventDefault(),this.focusedIndex=(this.focusedIndex+1)%t.length;break;case"ArrowUp":e.preventDefault(),this.focusedIndex=this.focusedIndex<=0?t.length-1:this.focusedIndex-1;break;case"Enter":case" ":e.preventDefault(),this.focusedIndex>=0&&t[this.focusedIndex]&&this.selectItem(t[this.focusedIndex]);break;case"ArrowRight":this.focusedIndex>=0&&t[this.focusedIndex]?.children?.length&&(this.submenuOpen=t[this.focusedIndex].id);break;case"ArrowLeft":this.submenuOpen=null;break}}async show(e,t,r){this.disabled||(this.targetElement=r||null,this.position=this.adjustPosition(e,t),this.open=!0,this.focusedIndex=-1,this.submenuOpen=null,this.erxOpenChange.emit({open:!0,position:this.position,target:this.targetElement}))}async close(){this.open=!1,this.erxOpenChange.emit({open:!1,position:this.position,target:this.targetElement})}handleContextMenu=e=>{this.disabled||(e.preventDefault(),this.show(e.clientX,e.clientY,e.target))};adjustPosition(e,t){const i=this.items.length*40,s=8;let o=e,a=t;return e+200>window.innerWidth-s&&(o=window.innerWidth-200-s),t+i>window.innerHeight-s&&(a=window.innerHeight-i-s),{x:o,y:a}}selectItem(e){if(!e.disabled){if(e.children?.length){this.submenuOpen=this.submenuOpen===e.id?null:e.id;return}this.erxSelect.emit({item:e,position:this.position,target:this.targetElement}),this.close()}}renderItem(e,t){if(e.type==="divider")return n("div",{class:"erx-ctx__divider",part:"divider"});if(e.type==="header")return n("div",{class:"erx-ctx__header",part:"header"},e.label);const r=e.children&&e.children.length>0;return n("div",{class:"erx-ctx__item-wrapper"},n("button",{class:{"erx-ctx__item":!0,"erx-ctx__item--disabled":!!e.disabled,"erx-ctx__item--danger":!!e.danger,"erx-ctx__item--focused":t===this.focusedIndex,"erx-ctx__item--has-children":!!r},onClick:()=>this.selectItem(e),onMouseEnter:()=>r&&(this.submenuOpen=e.id),disabled:e.disabled,role:"menuitem",part:"item"},e.icon&&n("span",{class:"erx-ctx__icon"},e.icon),n("span",{class:"erx-ctx__label"},e.label),e.shortcut&&n("span",{class:"erx-ctx__shortcut"},e.shortcut),r&&n("span",{class:"erx-ctx__arrow"},"â–¶")),r&&this.submenuOpen===e.id&&n("div",{class:"erx-ctx__submenu",part:"submenu"},e.children.map((i,s)=>this.renderItem(i,s))))}render(){return this.open?n("div",{class:"erx-ctx",style:{left:`${this.position.x}px`,top:`${this.position.y}px`},role:"menu",part:"menu"},this.items.map((e,t)=>this.renderItem(e,t))):null}};h.style=l();export{h as erx_context_menu};
