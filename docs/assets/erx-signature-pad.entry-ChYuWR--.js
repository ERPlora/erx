import{r as n,c as a,g as r,h as s}from"./index-DLMfuaWg.js";const o=()=>":host{display:block;font-family:-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif}.erx-sig--disabled{opacity:0.6;pointer-events:none}.erx-sig__label{display:block;font-size:13px;font-weight:500;color:var(--erx-text-secondary, #6b7280);margin-bottom:8px}.erx-sig__canvas-wrapper{position:relative;border:1px solid var(--erx-border-color, #e5e7eb);border-radius:8px;overflow:hidden;background:white}.erx-sig__canvas{display:block;cursor:crosshair;touch-action:none}.erx-sig__placeholder{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);font-size:14px;color:var(--erx-text-tertiary, #9ca3af);pointer-events:none}.erx-sig__actions{display:flex;justify-content:flex-end;gap:8px;margin-top:8px}.erx-sig__clear-btn{height:36px;padding:0 16px;border:1px solid var(--erx-border-color, #e5e7eb);border-radius:6px;background:var(--erx-surface, #fff);color:var(--erx-text-secondary, #6b7280);font-size:13px;font-weight:500;cursor:pointer;transition:all 150ms ease}.erx-sig__clear-btn:hover:not(:disabled){background:var(--erx-surface-secondary, #f9fafb)}.erx-sig__clear-btn:disabled{opacity:0.5;cursor:not-allowed}@media (prefers-color-scheme: dark){:host{color-scheme:dark}}:host-context(.dark) .erx-sig__canvas-wrapper,:host(.dark) .erx-sig__canvas-wrapper{border-color:var(--erx-border-color)}",h=class{constructor(t){n(this,t),this.erxChange=a(this,"erxChange"),this.erxClear=a(this,"erxClear")}get el(){return r(this)}config={};disabled=!1;label;isEmpty=!0;canvasRef;ctx;isDrawing=!1;points=[];lastPoint;erxChange;erxClear;componentDidLoad(){this.initCanvas(),this.setupEventListeners()}disconnectedCallback(){this.removeEventListeners()}async clear(){this.ctx&&this.canvasRef&&(this.ctx.fillStyle=this.config.backgroundColor||"#ffffff",this.ctx.fillRect(0,0,this.canvasRef.width,this.canvasRef.height),this.points=[],this.isEmpty=!0,this.erxClear.emit(),this.erxChange.emit({isEmpty:!0}))}async toDataURL(t){if(!this.canvasRef)return"";const e=t||this.config.format||"png",i=this.config.quality||.92;return e==="jpeg"?this.canvasRef.toDataURL("image/jpeg",i):this.canvasRef.toDataURL("image/png")}async isEmpty_(){return this.isEmpty}get width(){return this.config.width||400}get height(){return this.config.height||200}get lineWidth(){return this.config.lineWidth||2}get lineColor(){return this.config.lineColor||"#000000"}initCanvas(){this.canvasRef&&(this.ctx=this.canvasRef.getContext("2d"),this.canvasRef.width=this.width,this.canvasRef.height=this.height,this.ctx.fillStyle=this.config.backgroundColor||"#ffffff",this.ctx.fillRect(0,0,this.width,this.height),this.ctx.strokeStyle=this.lineColor,this.ctx.lineWidth=this.lineWidth,this.ctx.lineCap="round",this.ctx.lineJoin="round")}setupEventListeners(){this.canvasRef&&(this.canvasRef.addEventListener("mousedown",this.handleStart),this.canvasRef.addEventListener("mousemove",this.handleMove),this.canvasRef.addEventListener("mouseup",this.handleEnd),this.canvasRef.addEventListener("mouseleave",this.handleEnd),this.canvasRef.addEventListener("touchstart",this.handleTouchStart,{passive:!1}),this.canvasRef.addEventListener("touchmove",this.handleTouchMove,{passive:!1}),this.canvasRef.addEventListener("touchend",this.handleEnd))}removeEventListeners(){this.canvasRef&&(this.canvasRef.removeEventListener("mousedown",this.handleStart),this.canvasRef.removeEventListener("mousemove",this.handleMove),this.canvasRef.removeEventListener("mouseup",this.handleEnd),this.canvasRef.removeEventListener("mouseleave",this.handleEnd),this.canvasRef.removeEventListener("touchstart",this.handleTouchStart),this.canvasRef.removeEventListener("touchmove",this.handleTouchMove),this.canvasRef.removeEventListener("touchend",this.handleEnd))}getPointFromEvent(t){const e=this.canvasRef.getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top,time:Date.now()}}handleStart=t=>{this.disabled||(this.isDrawing=!0,this.lastPoint=this.getPointFromEvent(t),this.points.push(this.lastPoint))};handleMove=t=>{if(!this.isDrawing||this.disabled)return;const e=this.getPointFromEvent(t);this.drawLine(this.lastPoint,e),this.lastPoint=e,this.points.push(e)};handleEnd=()=>{this.isDrawing&&(this.isDrawing=!1,this.isEmpty=this.points.length===0,this.emitChange())};handleTouchStart=t=>{if(t.preventDefault(),this.disabled)return;this.isDrawing=!0;const e=t.touches[0];this.lastPoint=this.getPointFromEvent(e),this.points.push(this.lastPoint)};handleTouchMove=t=>{if(t.preventDefault(),!this.isDrawing||this.disabled)return;const e=t.touches[0],i=this.getPointFromEvent(e);this.drawLine(this.lastPoint,i),this.lastPoint=i,this.points.push(i)};drawLine(t,e){this.ctx&&(this.ctx.beginPath(),this.ctx.moveTo(t.x,t.y),this.ctx.lineTo(e.x,e.y),this.ctx.stroke(),this.isEmpty=!1)}async emitChange(){const t=await this.toDataURL();this.erxChange.emit({isEmpty:this.isEmpty,dataUrl:this.isEmpty?void 0:t})}render(){return s("div",{key:"a5e22d307ccb02bf7fc5dcacdf833b952b999251",class:{"erx-sig":!0,"erx-sig--disabled":this.disabled},part:"container"},this.label&&s("label",{key:"d4851a74703a0c2257a588683d03034e1b299f47",class:"erx-sig__label"},this.label),s("div",{key:"5471a3f6c3567f607c3909b1246b38cd1674863c",class:"erx-sig__canvas-wrapper",part:"canvas-wrapper"},s("canvas",{key:"479bed898d6ffd7e5bf7027763443579ae0b23ad",ref:t=>this.canvasRef=t,class:"erx-sig__canvas",part:"canvas"}),this.isEmpty&&s("div",{key:"816de322b6fe8fcbd1870828f39839bdf52438f5",class:"erx-sig__placeholder"},"Sign here")),s("div",{key:"866c967abb1de1e76f47ae3d835ed2533b81daa7",class:"erx-sig__actions",part:"actions"},s("button",{key:"955ebbe0384d35392dda6d05fc48625e725ce08a",class:"erx-sig__clear-btn",onClick:()=>this.clear(),disabled:this.disabled||this.isEmpty,type:"button"},"Clear")))}};h.style=o();export{h as erx_signature_pad};
