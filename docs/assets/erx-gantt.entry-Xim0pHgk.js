import{r as h,c as d,h as a}from"./index-DLMfuaWg.js";const p=()=>":host{display:block;font-family:-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif}.erx-gantt{background:var(--erx-surface, #fff);border-radius:12px;border:1px solid var(--erx-border-color, #e5e7eb);overflow:hidden}.erx-gantt--disabled{opacity:0.6;pointer-events:none}.erx-gantt__toolbar{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;border-bottom:1px solid var(--erx-border-color, #e5e7eb);background:var(--erx-surface-secondary, #f9fafb)}.erx-gantt__nav{display:flex;gap:4px}.erx-gantt__nav-btn{width:32px;height:32px;border:1px solid var(--erx-border-color, #e5e7eb);border-radius:6px;background:var(--erx-surface, #fff);color:var(--erx-text, #111827);font-size:14px;cursor:pointer;transition:all 150ms ease}.erx-gantt__nav-btn:hover{background:var(--erx-surface-tertiary, #f3f4f6)}.erx-gantt__view-modes{display:flex;gap:4px}.erx-gantt__view-btn{height:32px;padding:0 12px;border:1px solid var(--erx-border-color, #e5e7eb);border-radius:6px;background:var(--erx-surface, #fff);color:var(--erx-text-secondary, #6b7280);font-size:12px;font-weight:500;cursor:pointer;transition:all 150ms ease}.erx-gantt__view-btn:hover{background:var(--erx-surface-tertiary, #f3f4f6)}.erx-gantt__view-btn--active{background:var(--erx-color-primary, #667eea);border-color:var(--erx-color-primary, #667eea);color:white}.erx-gantt__content{position:relative;overflow-x:auto}.erx-gantt__header{display:flex;border-bottom:1px solid var(--erx-border-color, #e5e7eb);position:sticky;top:0;background:var(--erx-surface, #fff);z-index:10}.erx-gantt__task-header{width:200px;min-width:200px;padding:12px 16px;font-size:12px;font-weight:600;text-transform:uppercase;color:var(--erx-text-secondary, #6b7280);border-right:1px solid var(--erx-border-color, #e5e7eb)}.erx-gantt__timeline-header{display:flex;flex:1}.erx-gantt__col-header{flex:1;min-width:60px;padding:12px 8px;text-align:center;font-size:11px;font-weight:500;color:var(--erx-text-secondary, #6b7280);border-right:1px solid var(--erx-border-color, #e5e7eb)}.erx-gantt__col-header:last-child{border-right:none}.erx-gantt__col-header--today{background:rgba(102,126,234,0.1);color:var(--erx-color-primary, #667eea);font-weight:600}.erx-gantt__body{min-height:200px}.erx-gantt__row{display:flex;border-bottom:1px solid var(--erx-border-color, #e5e7eb)}.erx-gantt__row:last-child{border-bottom:none}.erx-gantt__row:hover{background:var(--erx-surface-secondary, #f9fafb)}.erx-gantt__task-cell{width:200px;min-width:200px;padding:8px;display:flex;align-items:center;gap:8px;border-right:1px solid var(--erx-border-color, #e5e7eb)}.erx-gantt__toggle{width:16px;height:16px;border:none;background:transparent;color:var(--erx-text-tertiary, #9ca3af);cursor:pointer;font-size:10px;padding:0}.erx-gantt__task-name{flex:1;font-size:13px;color:var(--erx-text, #111827);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;cursor:pointer}.erx-gantt__task-name:hover{color:var(--erx-color-primary, #667eea)}.erx-gantt__assignee{flex-shrink:0}.erx-gantt__assignee-avatar{width:24px;height:24px;border-radius:50%;-o-object-fit:cover;object-fit:cover}.erx-gantt__assignee-initial{width:24px;height:24px;border-radius:50%;background:rgba(102,126,234,0.1);display:flex;align-items:center;justify-content:center;font-size:10px;font-weight:600;color:var(--erx-color-primary, #667eea)}.erx-gantt__bar-cell{flex:1;position:relative;min-height:40px}.erx-gantt__bar-container{position:absolute;top:50%;transform:translateY(-50%);left:0;right:0;height:24px}.erx-gantt__bar{position:absolute;height:24px;border-radius:4px;cursor:pointer;transition:all 150ms ease;display:flex;align-items:center;justify-content:flex-end;padding-right:8px;min-width:40px}.erx-gantt__bar:hover{filter:brightness(1.1);box-shadow:0 2px 8px rgba(0,0,0,0.15)}.erx-gantt__progress{position:absolute;left:0;top:0;bottom:0;background:rgba(0,0,0,0.15);border-radius:4px 0 0 4px}.erx-gantt__bar-label{font-size:10px;font-weight:600;color:white;text-shadow:0 1px 2px rgba(0,0,0,0.2);position:relative;z-index:1}.erx-gantt__milestone{position:absolute;width:20px;height:20px;transform:translateX(-50%) rotate(45deg);cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:12px}.erx-gantt__today-line{position:absolute;top:0;bottom:0;width:2px;background:var(--erx-color-danger, #ef4444);z-index:5;pointer-events:none}.erx-gantt__today-line::before{content:'Today';position:absolute;top:-20px;left:50%;transform:translateX(-50%);font-size:10px;font-weight:600;color:var(--erx-color-danger, #ef4444);white-space:nowrap}.erx-gantt__empty{padding:48px;text-align:center;color:var(--erx-text-tertiary, #9ca3af);font-size:14px}@media (prefers-color-scheme: dark){:host{color-scheme:dark}}:host-context(.dark) .erx-gantt,:host(.dark) .erx-gantt{background:var(--erx-surface);border-color:var(--erx-border-color)}:host-context(.dark) .erx-gantt__toolbar,:host(.dark) .erx-gantt__toolbar{background:var(--erx-surface-secondary)}:host-context(.dark) .erx-gantt__task-name,:host(.dark) .erx-gantt__task-name{color:var(--erx-text)}:host-context(.dark) .erx-gantt__header,:host(.dark) .erx-gantt__header{background:var(--erx-surface)}",f=class{constructor(e){h(this,e),this.erxSelect=d(this,"erxSelect"),this.erxUpdate=d(this,"erxUpdate"),this.erxViewChange=d(this,"erxViewChange")}tasks=[];config={viewMode:"week"};disabled=!1;viewStart=new Date;collapsedTasks=new Set;erxSelect;erxUpdate;erxViewChange;componentWillLoad(){this.config.startDate?this.viewStart=new Date(this.config.startDate):this.viewStart=this.getEarliestDate()}getEarliestDate(){if(this.tasks.length===0)return new Date;const e=this.tasks.map(t=>new Date(t.start).getTime());return new Date(Math.min(...e))}getColumns(){const e=[],t=new Date(this.viewStart);t.setHours(0,0,0,0);const r=this.config.viewMode==="day"?14:this.config.viewMode==="week"||this.config.viewMode==="month"?12:8;for(let o=0;o<r;o++)e.push(new Date(t)),this.config.viewMode==="day"?t.setDate(t.getDate()+1):this.config.viewMode==="week"?t.setDate(t.getDate()+7):this.config.viewMode==="month"?t.setMonth(t.getMonth()+1):t.setMonth(t.getMonth()+3);return e}formatColumnHeader(e){return this.config.viewMode==="day"?e.toLocaleDateString("en-US",{weekday:"short",day:"numeric"}):this.config.viewMode==="week"?`W${this.getWeekNumber(e)}`:this.config.viewMode==="month"?e.toLocaleDateString("en-US",{month:"short",year:"2-digit"}):`Q${Math.floor(e.getMonth()/3)+1} ${e.getFullYear()}`}getWeekNumber(e){const t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),r=t.getUTCDay()||7;t.setUTCDate(t.getUTCDate()+4-r);const o=new Date(Date.UTC(t.getUTCFullYear(),0,1));return Math.ceil(((t.getTime()-o.getTime())/864e5+1)/7)}getTaskPosition(e){const t=this.getColumns();if(t.length===0)return{left:"0%",width:"0%"};const r=new Date(e.start),o=new Date(e.end),n=t[0].getTime(),i=t[t.length-1].getTime(),s=i-n;if(s===0)return{left:"0%",width:"100%"};const c=Math.max(r.getTime(),n),l=Math.min(o.getTime(),i),g=(c-n)/s*100,x=(l-c)/s*100;return{left:`${Math.max(0,g)}%`,width:`${Math.max(2,x)}%`}}getStatusColor(e){const t={pending:"var(--erx-text-tertiary, #9ca3af)","in-progress":"var(--erx-color-primary, #667eea)",completed:"var(--erx-color-success, #10b981)",delayed:"var(--erx-color-danger, #ef4444)",cancelled:"var(--erx-text-tertiary, #9ca3af)"};return t[e||"pending"]||t.pending}isToday(e){const t=new Date;return e.toDateString()===t.toDateString()}handleTaskSelect(e){this.erxSelect.emit({task:e})}toggleTask(e,t){t.stopPropagation();const r=new Set(this.collapsedTasks);r.has(e)?r.delete(e):r.add(e),this.collapsedTasks=r}navigate(e){const t=new Date(this.viewStart),r=this.config.viewMode==="day"?7:this.config.viewMode==="week"?4:this.config.viewMode==="month"?3:1;this.config.viewMode==="day"?t.setDate(t.getDate()+(e==="next"?r:-r)):this.config.viewMode==="week"?t.setDate(t.getDate()+(e==="next"?r*7:-r*7)):this.config.viewMode==="month"?t.setMonth(t.getMonth()+(e==="next"?r:-r)):t.setMonth(t.getMonth()+(e==="next"?r*3:-r*3)),this.viewStart=t,this.erxViewChange.emit({viewMode:this.config.viewMode,startDate:t})}renderTask(e,t=0){const r=e.children&&e.children.length>0,o=this.collapsedTasks.has(e.id),n=this.getTaskPosition(e);return[a("div",{class:"erx-gantt__row",key:e.id},a("div",{class:"erx-gantt__task-cell",style:{paddingLeft:`${t*20+8}px`}},r&&a("button",{class:"erx-gantt__toggle",onClick:i=>this.toggleTask(e.id,i)},o?"▶":"▼"),a("span",{class:"erx-gantt__task-name",onClick:()=>this.handleTaskSelect(e)},e.name),e.assignee&&a("span",{class:"erx-gantt__assignee"},e.assignee.avatar?a("img",{src:e.assignee.avatar,alt:"",class:"erx-gantt__assignee-avatar"}):a("span",{class:"erx-gantt__assignee-initial"},e.assignee.name.charAt(0)))),a("div",{class:"erx-gantt__bar-cell"},a("div",{class:"erx-gantt__bar-container"},e.milestone?a("div",{class:"erx-gantt__milestone",style:{left:n.left,background:e.color||this.getStatusColor(e.status)},onClick:()=>this.handleTaskSelect(e)},"◆"):a("div",{class:{"erx-gantt__bar":!0,[`erx-gantt__bar--${e.status||"pending"}`]:!0},style:{left:n.left,width:n.width,background:e.color||this.getStatusColor(e.status)},onClick:()=>this.handleTaskSelect(e)},this.config.showProgress&&a("div",{class:"erx-gantt__progress",style:{width:`${e.progress}%`}}),a("span",{class:"erx-gantt__bar-label"},e.progress,"%"))))),r&&!o&&e.children.map(i=>this.renderTask(i,t+1))]}render(){const e=this.getColumns();return a("div",{key:"bd341a8d169f8ecc47a28b2d8b0e2802eff4591b",class:{"erx-gantt":!0,"erx-gantt--disabled":this.disabled},part:"container"},a("div",{key:"0396a4c94d88f5e3dbb029413310eb531993f9b8",class:"erx-gantt__toolbar",part:"toolbar"},a("div",{key:"93ecaf1b55384bb73187e8a4eafa8bbbf8a21ec0",class:"erx-gantt__nav"},a("button",{key:"de520d1c6cc67a1e283bde64b169af6a372de50f",class:"erx-gantt__nav-btn",onClick:()=>this.navigate("prev")},"←"),a("button",{key:"895815f7a0502268b38e0a8dcd207ac84320b905",class:"erx-gantt__nav-btn",onClick:()=>this.navigate("next")},"→")),a("div",{key:"6d871a93474accbaa1c3848ec4971c4d96cad4e0",class:"erx-gantt__view-modes"},["day","week","month","quarter"].map(t=>a("button",{class:{"erx-gantt__view-btn":!0,"erx-gantt__view-btn--active":this.config.viewMode===t},onClick:()=>{this.config={...this.config,viewMode:t},this.erxViewChange.emit({viewMode:t,startDate:this.viewStart})}},t.charAt(0).toUpperCase()+t.slice(1))))),a("div",{key:"e527ee861a09d358f7fbb397e782cee3fb5ab795",class:"erx-gantt__content",part:"content"},a("div",{key:"a497b911343d1f3087c837fc301a4d1d0fa17628",class:"erx-gantt__header"},a("div",{key:"9126672eae495c9dc766a3348e3df0d96df16955",class:"erx-gantt__task-header"},"Task"),a("div",{key:"02dede0727672d15db42194204aaa2ddf6441bb5",class:"erx-gantt__timeline-header"},e.map(t=>a("div",{class:{"erx-gantt__col-header":!0,"erx-gantt__col-header--today":this.config.viewMode==="day"&&this.isToday(t)},key:t.getTime()},this.formatColumnHeader(t))))),a("div",{key:"671ae703ca1f6fbc7892cf3b789dc4da9b86ce9d",class:"erx-gantt__body",part:"body"},this.tasks.length===0?a("div",{class:"erx-gantt__empty"},"No tasks to display"):this.tasks.map(t=>this.renderTask(t))),this.config.showToday&&a("div",{key:"8628e84346a6138eadd2d510ce76b57b6247cb91",class:"erx-gantt__today-line",style:{left:`calc(${(new Date().getTime()-e[0].getTime())/(e[e.length-1].getTime()-e[0].getTime())*100}% + 200px)`}})))}};f.style=p();export{f as erx_gantt};
